<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: networking | Random Notes]]></title>
  <link href="http://devrandom.za.net/blog/categories/networking/atom.xml" rel="self"/>
  <link href="http://devrandom.za.net/"/>
  <updated>2014-12-17T10:05:21+02:00</updated>
  <id>http://devrandom.za.net/</id>
  <author>
    <name><![CDATA[S.J. Louw]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[OSPF Path Selection Order of Preference and Summarization]]></title>
    <link href="http://devrandom.za.net/blog/2014/12/16/ospf-path-selection-order-of-preference-and-summarization/"/>
    <updated>2014-12-16T22:19:58+02:00</updated>
    <id>http://devrandom.za.net/blog/2014/12/16/ospf-path-selection-order-of-preference-and-summarization</id>
    <content type="html"><![CDATA[<p><img class="left" src="/images/blog_posts/ospf.png"></p>

<p>My shortish summarized version of OSPF Path Selection Order of Preference and Summarization.</p>

<!--more-->


<br>


<br>


<br>


<h3>Path Selection:</h3>

<p>These rules apply in THIS order even if the OSPF link metric (Cost value) is changed.</p>

<ol>
<li>Intra Area Routes (O)</li>
<li>Inter Area Routes (O IA)</li>
<li>External Type 1 (E1)</li>
<li>External Type 2 (E2)</li>
<li>NSSA Type 1 (N1)</li>
<li>NSSA TYpe 2 (N2)</li>
</ol>


<p><strong>Interface cost is derived from the bandwidth. The formula is:</strong></p>

<p>Cost = Reference / Bandwidth. (Rounded down to the closest integer)</p>

<p>By default, Reference = 100000 (Kb/s)</p>

<p><strong>NOTES:</strong>
&ndash; Changing cost values, you need to use the <code>ip ospf cost &lt;COST_VALUE&gt;</code> command on the interface and NOT the <code>bandwidth</code> statement. The <code>bandwidth</code> command is also used for other traffic minipulation techniques like QoS and will break those.</p>

<p>On FastE, GigE, TenGigE and 100GigE the default OSPF cost will be &ldquo;1&rdquo;, so you WILL want to change this!</p>

<h3>Summarization:</h3>

<p>All routers inside the area MUST have exactly the same LSDB to be able to summarize!</p>

<p><strong>Summarization can ONLY be done:</strong></p>

<ul>
<li>between areas (ABR) with <code>area &lt;SOURCE_AREA&gt; range &lt;ADDRESS&gt; &lt;MASK&gt;</code></li>
<li>during redistribution (ASBR) from another protocol with <code>summary-address &lt;ADDRESS&gt; &lt;MASK&gt;</code></li>
</ul>


<p>It is possible to &lsquo;black hole&rsquo; the traffic or sub-optimal route within the domain with OSPF summarization. OSPF will AUTO create a discard route with the <strong>Null0</strong> interface as the next-hop to prevent the router from using a shorter match (0.0.0.0), if the more specific destination network is not present in the routing table. This behavior can be disabled with <code>no discard-route &lt;INTERNAL|EXTERNAL&gt;</code>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OSPF LSA's, Area Types, Network Types and Timers]]></title>
    <link href="http://devrandom.za.net/blog/2014/12/14/ospf-lsas-areas-networks-timers/"/>
    <updated>2014-12-14T22:41:32+02:00</updated>
    <id>http://devrandom.za.net/blog/2014/12/14/ospf-lsas-areas-networks-timers</id>
    <content type="html"><![CDATA[<p><img class="left" src="/images/blog_posts/ospf.png"></p>

<p>My shortish summarized version of the OSPF Link State Advertisements, Area Types, Network Types and Timers.</p>

<!--more-->


<br>


<br>


<br>


<h3>OSPF Link State Advertisements (LSA&rsquo;s):</h3>

<br>


<table>
<thead>
<tr>
<th align="center"> LSA </th>
<th align="left">      Name     </th>
<th align="left">                 Description                 </th>
<th align="left">                       Area                       </th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"> 1   </td>
<td align="left"> Router LSA    </td>
<td align="left">  Generated by Any router for any/all links  </td>
<td align="left">                    Intra-area                    </td>
</tr>
<tr>
<td align="center"> 2   </td>
<td align="left"> Network LSA   </td>
<td align="left">   Generated by a DR only for DR-used-links  </td>
<td align="left">                    Intra-area                    </td>
</tr>
<tr>
<td align="center"> 3   </td>
<td align="left"> Summary LSA   </td>
<td align="left">    Generated by ABRs to summarize 1 &amp; 2&rsquo;s   </td>
<td align="left">                    Inter-area                    </td>
</tr>
<tr>
<td align="center"> 4   </td>
<td align="left"> ASBR Summary  </td>
<td align="left"> Generated by ABRs to summarize NH of Type 5 </td>
<td align="left">                    Inter-area                    </td>
</tr>
<tr>
<td align="center"> 5   </td>
<td align="left"> External LSA  </td>
<td align="left">              Generated by ASBR              </td>
<td align="left">        Domain-wide (other than stub areas)       </td>
</tr>
<tr>
<td align="center"> 7   </td>
<td align="left"> NSSA External </td>
<td align="left">   Generated by ASBR specific to NSSA area   </td>
<td align="left"> NSSA only &ndash; Translated to Type 5 for other areas</td>
</tr>
</tbody>
</table>


<br>


<p><strong>Type1</strong> &ndash; Originated by all routers to tell the other routers in the area about their connected links.</p>

<p><strong>Type2</strong> &ndash; Originated by the DR in the area. Simplifies the graph of the area when there are multiple routers on the same segment.</p>

<p><strong>Type3</strong> &ndash; Originated by the ABR. Describes routes in other areas.</p>

<p><strong>Type4</strong> &ndash; Originated by the ABR. Describes inter-area reachability to a router that performed redistribution.</p>

<p><strong>Type5</strong> &ndash; Originated by the ASBR that performs the redistribution. Describes redistributed routes from another protocol.</p>

<p><strong>Type7</strong> &ndash; Originated by the ASBR, but ONLY applies to NSSA external areas. (Converted to type 5 LSA when the ABR of the NSSA originates them into area 0)</p>

<br>


<table>
<thead>
<tr>
<th align="center">LSA </th>
<th align="center">    Area    </th>
<th align="center"> RIB Indentifier </th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"> 1   </td>
<td align="center"> Intra-area </td>
<td align="center">        O        </td>
</tr>
<tr>
<td align="center"> 2   </td>
<td align="center"> Intra-area </td>
<td align="center">        O        </td>
</tr>
<tr>
<td align="center"> 3   </td>
<td align="center"> Inter-area </td>
<td align="center">       O IA      </td>
</tr>
<tr>
<td align="center"> 4   </td>
<td align="center"> Inter-area </td>
<td align="center">       O IA      </td>
</tr>
<tr>
<td align="center"> 5   </td>
<td align="center"> External   </td>
<td align="center">     E1 or E2    </td>
</tr>
<tr>
<td align="center"> 7   </td>
<td align="center"> External   </td>
<td align="center">     N1 or N2    </td>
</tr>
</tbody>
</table>


<h3>OSPF Area Types:</h3>

<ul>
<li><strong>stub</strong> = 1, 2, 3 + 0.0.0.0 default route</li>
<li><strong>total stub</strong> = 1, 2 + 0.0.0.0 default route</li>
<li><strong>NSSA</strong> = 1, 2, 3, 7  (0.0.0.0 default route is not automatically created although you can add it)</li>
<li><strong>total NSSA</strong> = 1, 2, 7 + 0.0.0.0 default route</li>
</ul>


<p>Anything that says <strong>&ldquo;total&rdquo;</strong> must get the <code>"no-summary"</code> on the CLI.</p>

<p><strong>NOTES:</strong></p>

<ol>
<li><p>If the NSSA ASBR is also an ABR, <strong>Type7</strong> LSA&rsquo;s will be originated into the NSSA and <strong>Type5</strong> LSA&rsquo;s will be originated into <strong>Area 0</strong>. <strong>Type7</strong> LSA origination into the NSSA, in this case, can be suppressed with <code>area &lt;AREA_NUM&gt; nssa no-redistribution</code>.</p></li>
<li><p>If multiple ABR&rsquo;s only one will perform NSSA Type7 to Type5 translation, based on ABR with highest <strong>Router-ID</strong>.</p></li>
<li><p>If the Forwarding Address (FA) for an external prefix is NOT reachable/filtered, the router will NOT install it into the route table nor will it translate Type7 to Type5 LSA&rsquo;s. This can be &ldquo;fixed&rdquo; by <code>area &lt;AREA_NUM&gt; nssa suppress-fa</code> on the ABR, thus setting the FA to itself (0.0.0.0).</p></li>
</ol>


<h3>OSPF Network Types:</h3>

<ul>
<li>Broadcast</li>
<li>Non-broadcast</li>
<li>Point-to-Point</li>
<li>Point-to-Multipoint</li>
<li>Point-to-Multipoint (Non-broadcast)</li>
</ul>


<p><strong>Mixing network types, combinations that will work:</strong></p>

<blockquote><p>Reason why some network types are not compatible with other is Network Types that use DR election will only be compatible with other types that also elects/requires DR election.</p></blockquote>

<ul>
<li>Broadcast to Broadcast</li>
<li>Non-Broadcast to Non-Broadcast</li>
<li>Point-to-Point to Point-to-Point</li>
<li>Point-to-Multipoint to Point-to-Multipoint</li>
<li>Broadcast to Non-Broadcast (MUST adjust hello/dead timers to form adjacency)</li>
<li>Point-to-Point to Point-to-Multipoint (MUST adjust hello/dead timers to form adjacency)</li>
</ul>


<p><strong>Point-to-(anything)</strong> does not use a DR.</p>

<p><strong>(anything)-to-Multipoint</strong> adds a /32 route advertisement. The DR and BDR is the only routers that is REQUIRED to peer with all other routers when <strong>&ldquo;Multipoint&rdquo;</strong> networks is used.</p>

<h3>OSPF Network Type Timers (Hello/Dead):</h3>

<p>Anything with <strong>&ldquo;multi&rdquo;</strong> or <strong>&ldquo;non&rdquo;</strong> uses slow timers <code>(30/120)</code>, others use fast timers <code>(10/40)</code>.</p>
]]></content>
  </entry>
  
</feed>
